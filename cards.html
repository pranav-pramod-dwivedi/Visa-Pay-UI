<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NovaPay | Cards</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@500&display=swap');
        
        :root {
            --visa-blue: #0052FF;
            --visa-dark: #002D8F;
            --surface: #FFFFFF;
            --frost-color: rgba(255, 255, 255, 0.6);
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: var(--surface);
            color: #0F172A;
            margin: 0;
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
        }

        body.lock-scroll { overflow: hidden; }

        /* --- SKELETON LOADING --- */
        .skeleton-block { background: #f1f5f9; position: relative; overflow: hidden; border-radius: 12px; }
        .skeleton-block::after { content: ""; position: absolute; inset: 0; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.8), transparent); animation: shimmer 0.8s infinite linear; }
        @keyframes shimmer { 0% { transform: translateX(-100%); } 100% { transform: translateX(100%); } }
        #skeleton-screen { position: fixed; inset: 0; background: white; z-index: 2000; transition: opacity 0.5s ease; padding: 24px; }
        .loaded #skeleton-screen { opacity: 0; pointer-events: none; }

        /* --- HOLOGRAPHIC GLASS CARD --- */
        .card-stage {
            perspective: 1200px;
            width: 100%;
            display: flex; justify-content: center;
            margin-bottom: 20px;
            position: relative;
            z-index: 20;
        }

        .card-wrapper {
            width: 100%; aspect-ratio: 1.586 / 1; position: relative;
            transform-style: preserve-3d; transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer; border-radius: 24px;
        }
        
        .card-wrapper.flipped { transform: rotateY(180deg) !important; transition: transform 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275); }

        /* --- ZIG-ZAG FORCEFIELD FREEZE --- */
        .card-wrapper.frozen { filter: grayscale(100%) contrast(1.2) brightness(0.7); }
        
        .forcefield-layer {
            position: absolute; inset: 0; pointer-events: none; border-radius: 24px; z-index: 40; opacity: 0; transition: opacity 0.4s ease;
            background-image: repeating-linear-gradient(45deg, rgba(59, 130, 246, 0.15) 0px, rgba(59, 130, 246, 0.15) 2px, transparent 2px, transparent 10px),
                              repeating-linear-gradient(-45deg, rgba(59, 130, 246, 0.15) 0px, rgba(59, 130, 246, 0.15) 2px, transparent 2px, transparent 10px);
            background-size: 20px 20px;
            box-shadow: inset 0 0 40px rgba(59, 130, 246, 0.4);
            border: 2px solid rgba(59, 130, 246, 0.6);
            backdrop-filter: blur(1px);
        }
        
        .forcefield-scan {
            position: absolute; top: 0; left: 0; width: 100%; height: 4px;
            background: #3b82f6;
            box-shadow: 0 0 20px #3b82f6;
            animation: scanDown 2s infinite linear;
            opacity: 0;
        }

        .frozen .forcefield-layer { opacity: 1; }
        .frozen .forcefield-scan { opacity: 1; }
        .frozen .lock-overlay { opacity: 1; transform: translate(-50%, -50%) scale(1); }

        @keyframes scanDown { 0% { top: 0; } 100% { top: 100%; } }

        .lock-overlay {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0);
            width: 70px; height: 70px; bg: white; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            background: #0F172A; border: 2px solid #3B82F6; color: #3B82F6;
            font-size: 1.8rem; z-index: 60; opacity: 0; pointer-events: none;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 0 30px rgba(59, 130, 246, 0.6);
        }

        .card-face {
            position: absolute; width: 100%; height: 100%;
            backface-visibility: hidden; border-radius: 24px;
            box-shadow: 0 20px 40px -10px rgba(0, 82, 255, 0.3);
            overflow: hidden;
            background: linear-gradient(135deg, rgba(0, 82, 255, 0.9) 0%, rgba(0, 45, 143, 0.95) 100%);
            border: 1px solid rgba(255,255,255,0.2);
            border-top: 1px solid rgba(255,255,255,0.4);
        }

        .front { display: flex; flex-direction: column; justify-content: space-between; padding: 24px; }
        .back { background: #1e293b; transform: rotateY(180deg); display: flex; flex-direction: column; color: white; }
        .mag-stripe { width: 100%; height: 45px; background: #000; width: 100%; margin-top: 30px; }
        .signature-strip {
            width: 80%; height: 35px; background: #fff; margin: 15px auto 0;
            border-radius: 4px; display: flex; align-items: center; justify-content: flex-end;
            padding-right: 10px; color: #1e293b;
            font-family: 'JetBrains Mono', monospace; font-style: italic; font-weight: 700;
            background-image: repeating-linear-gradient(45deg, #f1f5f9 0px, #f1f5f9 2px, #fff 2px, #fff 4px);
        }

        .holo-sheen {
            position: absolute; inset: 0;
            background: linear-gradient(115deg, transparent 20%, rgba(255,255,255,0.4) 45%, rgba(255,255,255,0.6) 50%, rgba(255,255,255,0.4) 55%, transparent 80%);
            mix-blend-mode: overlay; opacity: 0; transition: opacity 0.3s; pointer-events: none;
            transform: translateX(-100%); z-index: 10;
        }

        /* --- CONTROL GRID --- */
        .control-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 24px; }

        .control-btn {
            background: #FFFFFF; border: 1px solid #F1F5F9; border-radius: 20px;
            height: 90px; display: flex; flex-direction: column; align-items: center; justify-content: center;
            gap: 6px; transition: transform 0.1s;
            box-shadow: 0 4px 15px -5px rgba(0,0,0,0.03);
        }
        .control-btn:active { transform: scale(0.95); }
        .control-icon {
            width: 42px; height: 42px; border-radius: 12px; display: flex; align-items: center; justify-content: center;
            font-size: 1.1rem; transition: all 0.3s; z-index: 10;
        }
        
        .freeze-active { background: #F0F9FF; border-color: #BAE6FD; }
        .freeze-active .control-icon { background: #0EA5E9; color: white; box-shadow: 0 0 10px rgba(14, 165, 233, 0.4); }

        /* --- LIQUID GLASS --- */
        .liquid-card {
            background: white; border: 1px solid #F1F5F9; border-radius: 24px; padding: 20px;
            box-shadow: 0 10px 30px -5px rgba(0,0,0,0.05); display: flex; align-items: center; justify-content: space-between;
            margin-bottom: 24px;
        }
        .glass-cup {
            width: 60px; height: 90px;
            border: 3px solid #cbd5e1; border-top: none;
            border-bottom-left-radius: 16px; border-bottom-right-radius: 16px;
            position: relative; overflow: hidden; background: rgba(241, 245, 249, 0.5);
            transform: perspective(500px) rotateX(5deg);
        }
        .water {
            position: absolute; bottom: 0; left: 0; width: 100%;
            background: linear-gradient(to top, #2563eb, #60a5fa);
            transition: height 0.4s cubic-bezier(0.4, 0, 0.2, 1); opacity: 0.9;
            box-shadow: 0 0 15px rgba(37, 99, 235, 0.5);
        }
        .water::after {
            content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 6px;
            background: rgba(255,255,255,0.4);
        }

        /* --- ADD CARD MODAL --- */
        #add-card-modal {
            position: fixed; inset: 0; background: rgba(255, 255, 255, 0.1); z-index: 3000;
            display: none; align-items: flex-end; backdrop-filter: blur(0px); transition: all 0.4s ease;
        }
        #add-card-modal.active { backdrop-filter: blur(20px); background: rgba(15, 23, 42, 0.4); }

        .modal-sheet {
            width: 100%; max-width: 450px; background: white; border-top-left-radius: 32px; border-top-right-radius: 32px;
            padding: 30px; transform: translateY(100%); transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
            box-shadow: 0 -10px 40px rgba(0,0,0,0.1); margin: 0 auto;
        }
        #add-card-modal.active .modal-sheet { transform: translateY(0); }
        
        .input-group { position: relative; margin-bottom: 20px; }
        .input-field {
            width: 100%; padding: 16px; border: 1px solid #e2e8f0; border-radius: 16px;
            font-size: 14px; font-weight: 600; color: #1e293b; outline: none; transition: border-color 0.2s;
            background: #f8fafc; padding-top: 24px; padding-bottom: 8px;
        }
        .input-field:focus { border-color: #3b82f6; background: #fff; box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1); }
        .input-label {
            position: absolute; left: 16px; top: 16px; font-size: 14px; color: #94a3b8;
            pointer-events: none; transition: all 0.2s; font-weight: 500;
        }
        .input-field:focus ~ .input-label, .input-field:not(:placeholder-shown) ~ .input-label {
            top: 6px; left: 16px; font-size: 10px; color: #3b82f6; font-weight: 700;
        }
        .spinner { width: 24px; height: 24px; border: 3px solid #fff; border-top-color: transparent; border-radius: 50%; animation: spin 0.8s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* --- WALLET VORTEX RE-ADDED --- */
        #wallet-overlay {
            position: fixed; inset: 0; z-index: 4000; background: #000;
            display: none; align-items: center; justify-content: center; perspective: 1000px;
            flex-direction: column;
        }
        
        /* The Vortex Ring */
        .vortex {
            width: 300px; height: 300px; border-radius: 50%;
            border: 2px solid rgba(255,255,255,0.1);
            position: absolute; animation: vortexSpin 4s linear infinite;
        }
        .vortex::before {
            content: ""; position: absolute; inset: -10px; border-radius: 50%;
            border: 2px solid transparent; border-top-color: #0052FF; border-bottom-color: #00C2FF;
            animation: vortexSpin 2s linear infinite reverse;
        }
        @keyframes vortexSpin { to { transform: rotate(360deg); } }

        /* The Card Being Sucked In */
        .warp-card {
            width: 200px; aspect-ratio: 1.586/1; background: linear-gradient(135deg, #0052FF, #002D8F);
            border-radius: 16px; position: relative; z-index: 10;
            transform: scale(1) translateZ(0); opacity: 1;
            box-shadow: 0 0 50px rgba(0, 82, 255, 0.6);
        }
        
        .warp-active .warp-card {
            animation: warpSuck 1.5s cubic-bezier(0.55, 0.055, 0.675, 0.19) forwards;
        }

        @keyframes warpSuck {
            0% { transform: scale(1) translateZ(0) rotateY(0); filter: brightness(1); }
            50% { transform: scale(0.5) translateZ(-500px) rotateY(180deg); filter: brightness(2); }
            100% { transform: scale(0) translateZ(-1000px) rotateY(360deg); filter: brightness(5); opacity: 0; }
        }

        /* The Wallet Pass Emergence */
        .apple-pass {
            width: 240px; height: 160px; background: #1c1c1e; border-radius: 12px;
            position: absolute; opacity: 0; transform: translateY(100px) scale(0.8);
            display: flex; flex-direction: column; justify-content: space-between; padding: 20px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5); z-index: 20;
        }
        .pass-top { height: 20px; background: #0052FF; border-radius: 12px 12px 0 0; position: absolute; top: 0; left: 0; width: 100%; }
        
        .warp-active .apple-pass {
            animation: passEmergence 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) 1.5s forwards;
        }

        @keyframes passEmergence {
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        .success-tick-wallet {
            width: 50px; height: 50px; background: #34C759; border-radius: 50%; color: white;
            display: flex; align-items: center; justify-content: center; font-size: 1.5rem;
            position: absolute; bottom: -25px; right: -10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3); opacity: 0;
        }
        .warp-active .success-tick-wallet { animation: popTick 0.4s ease 2.2s forwards; }
        @keyframes popTick { to { transform: scale(1); opacity: 1; } }
        
        .dismiss-btn {
            position: absolute; bottom: 50px; color: #555; font-weight: 700; text-transform: uppercase;
            font-size: 12px; letter-spacing: 2px; opacity: 0; cursor: pointer; padding: 10px 20px;
            border: 1px solid #333; border-radius: 30px; background: rgba(0,0,0,0.5); color: white; border: 1px solid rgba(255,255,255,0.3);
        }
        .warp-active .dismiss-btn { animation: fadeInBtn 0.5s ease 2.5s forwards; }
        @keyframes fadeInBtn { to { opacity: 1; } }

        /* --- VISA POPUP --- */
        #visa-popup {
            position: fixed; inset: 0; z-index: 3500; background: rgba(0,0,0,0.6); backdrop-filter: blur(20px);
            display: none; align-items: center; justify-content: center; opacity: 0; transition: opacity 0.3s;
        }
        #visa-popup.active { opacity: 1; }
        .popup-box {
            background: white; width: 85%; max-width: 320px; padding: 30px; border-radius: 30px;
            text-align: center; transform: scale(0.9); transition: transform 0.3s;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        .active .popup-box { transform: scale(1); }

        /* --- WATCH NAV --- */
        .watch-strap {
            height: 54px; background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(20px);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08); border: 1px solid rgba(255, 255, 255, 0.6);
        }
        .watch-case {
            width: 68px; height: 68px; background: linear-gradient(135deg, #0052FF 0%, #002D8F 100%);
            box-shadow: 0 12px 30px rgba(0, 82, 255, 0.35); border: 4px solid white;
            position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); z-index: 10;
        }
        
        /* Toggles */
        .switch { position: relative; display: inline-block; width: 40px; height: 22px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #e2e8f0; transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: var(--visa-blue); }
        input:checked + .slider:before { transform: translateX(18px); }

        .range-slider { -webkit-appearance: none; width: 100%; height: 6px; background: #e2e8f0; border-radius: 10px; outline: none; margin-top: 10px; }
        .range-slider::-webkit-slider-thumb {
            -webkit-appearance: none; width: 22px; height: 22px; border-radius: 50%;
            background: white; border: 3px solid #0052FF; cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="max-w-md mx-auto relative bg-white">

    <!-- 1. Skeleton -->
    <div id="skeleton-screen">
        <div class="flex justify-between mb-8">
            <div class="w-32 h-8 rounded-full skeleton-block"></div>
            <div class="w-10 h-10 rounded-full skeleton-block"></div>
        </div>
        <div class="h-48 w-full rounded-[2rem] skeleton-block mb-10"></div>
        <div class="grid grid-cols-3 gap-3 mb-8">
            <div class="h-20 rounded-2xl skeleton-block"></div>
            <div class="h-20 rounded-2xl skeleton-block"></div>
            <div class="h-20 rounded-2xl skeleton-block"></div>
        </div>
    </div>

    <!-- 2. Main Content -->
    <div id="main-content" class="min-h-screen pb-40 px-6">
        
        <header class="pt-8 pb-6 flex justify-between items-center sticky top-0 bg-white/95 z-40 backdrop-blur-sm">
            <h1 class="text-[20px] font-extrabold text-slate-900 tracking-tight">Cards Hub</h1>
            <button onclick="openAddCard()" class="w-10 h-10 rounded-full bg-slate-50 flex items-center justify-center border border-slate-100 text-blue-600 active:scale-95 transition-transform">
                <i class="fa-solid fa-plus text-lg"></i>
            </button>
        </header>

        <!-- 3D GLASS CARD -->
        <div class="card-stage">
            <div class="card-wrapper" id="card-element" onclick="flipCard()">
                <div class="forcefield-layer"><div class="forcefield-scan"></div></div>
                <div class="lock-overlay"><i class="fa-solid fa-lock"></i></div>
                <!-- Front -->
                <div class="card-face front">
                    <div class="holo-sheen" id="sheen"></div>
                    <div class="flex justify-between items-start z-10">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5e/Visa_Inc._logo.svg/2560px-Visa_Inc._logo.svg.png" 
                             class="h-6 brightness-0 invert opacity-90" alt="Visa">
                        <i class="fa-solid fa-wifi rotate-90 text-white/50"></i>
                    </div>

                    <div class="z-10">
                        <div class="h-8 flex items-center mb-4">
                            <p id="card-number" class="text-[18px] font-mono tracking-widest drop-shadow-md">**** **** **** 8144</p>
                        </div>
                        <div class="flex justify-between items-end">
                            <div>
                                <p class="text-[9px] font-bold opacity-70 uppercase tracking-[0.2em] mb-1">Holder</p>
                                <p class="text-[13px] font-bold tracking-widest uppercase text-shadow-sm">Pranav D.</p>
                            </div>
                            <p class="text-[12px] font-bold opacity-90">12 / 27</p>
                        </div>
                    </div>
                </div>

                <!-- Back -->
                <div class="card-face back">
                    <div class="mag-stripe"></div>
                    <!-- Realistic Signature Strip -->
                    <div class="signature-strip">
                        <span class="cvv-box text-lg">772</span>
                    </div>
                    <p class="text-[8px] text-slate-400 mt-2 px-6">Authorized Signature - Not Valid Unless Signed</p>
                </div>
            </div>
        </div>

   <!-- 6-GRID CONTROLS -->
        <div class="control-grid">
            <button id="btn-freeze" class="control-btn" onclick="toggleFreeze(this)">
                <div class="control-icon bg-blue-50 text-blue-600"><i class="fa-regular fa-snowflake"></i></div>
                <span class="text-[10px] font-bold text-slate-600">Freeze</span>
            </button>
            <button class="control-btn" onclick="revealNumber(this)">
                <div class="control-icon bg-slate-50 text-slate-600"><i class="fa-regular fa-eye-slash"></i></div>
                <span class="text-[10px] font-bold text-slate-600">Reveal</span>
            </button>
            <button class="control-btn" onclick="scrollToLimit()">
                <div class="control-icon bg-slate-50 text-slate-600"><i class="fa-solid fa-sliders"></i></div>
                <span class="text-[10px] font-bold text-slate-600">Limits</span>
            </button>
            <button class="control-btn" onclick="triggerWallet()">
                <div class="control-icon bg-slate-50 text-slate-600"><i class="fa-brands fa-apple text-xl"></i></div>
                <span class="text-[10px] font-bold text-slate-600">Wallet</span>
            </button>
            <button class="control-btn" onclick="openVisaPopup('Reset PIN Protocol')">
                <div class="control-icon bg-slate-50 text-slate-600"><i class="fa-solid fa-key"></i></div>
                <span class="text-[10px] font-bold text-slate-600">Reset PIN</span>
            </button>
            <button class="control-btn" onclick="openVisaPopup('Lost Card Report')">
                <div class="control-icon bg-red-50 text-red-500"><i class="fa-solid fa-triangle-exclamation"></i></div>
                <span class="text-[10px] font-bold text-red-500">Report</span>
            </button>
        </div>

        <!-- LIQUID BUDGET -->
        <div class="liquid-card" id="limit-section">
            <div class="flex-1 pr-6">
                <div class="flex justify-between items-baseline mb-2">
                    <p class="text-[12px] font-bold text-slate-900">Monthly Cap</p>
                    <p class="text-[14px] font-black text-blue-600" id="limit-val">$10</p>
                </div>
                <p class="text-[10px] text-slate-400 font-bold mb-3">Spent: $3.00 <span id="spend-pct" class="text-blue-500 ml-1">(30.0%)</span></p>
                <input type="range" min="10" max="10000" value="10" class="range-slider w-full" oninput="updateLimit(this.value)">
                <div class="flex justify-between mt-1 text-[8px] text-slate-300 font-bold uppercase">
                    <span>Strict</span>
                    <span>Relaxed</span>
                </div>
            </div>
            <div class="glass-cup">
                <div class="water" id="water-fill" style="height: 30%;"></div>
            </div>
        </div>

        <!-- SETTINGS -->
        <div class="space-y-4">
            <h3 class="text-[10px] font-extrabold text-slate-400 uppercase tracking-widest px-2">Card Configuration</h3>
            <div class="bg-slate-50 rounded-[2rem] border border-slate-100 p-2">
                <div class="flex items-center justify-between p-4 border-b border-slate-200/50">
                    <div class="flex items-center gap-4">
                        <div class="w-8 h-8 bg-white rounded-lg flex items-center justify-center text-slate-500 shadow-sm"><i class="fa-solid fa-globe"></i></div>
                        <span class="text-[12px] font-bold text-slate-800">International Use</span>
                    </div>
                    <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                </div>
                <div class="flex items-center justify-between p-4 border-b border-slate-200/50">
                    <div class="flex items-center gap-4">
                        <div class="w-8 h-8 bg-white rounded-lg flex items-center justify-center text-slate-500 shadow-sm"><i class="fa-solid fa-wifi"></i></div>
                        <span class="text-[12px] font-bold text-slate-800">Contactless</span>
                    </div>
                    <label class="switch"><input type="checkbox" checked><span class="slider"></span></label>
                </div>
                <div class="flex items-center justify-between p-4">
                    <div class="flex items-center gap-4">
                        <div class="w-8 h-8 bg-white rounded-lg flex items-center justify-center text-slate-500 shadow-sm"><i class="fa-solid fa-map-pin"></i></div>
                        <span class="text-[12px] font-bold text-slate-800">ATM Geo-Fence</span>
                    </div>
                    <label class="switch"><input type="checkbox" checked><span class="slider"></span></label>
                </div>
            </div>
        </div>
    </div>

    <!-- 3. ADD CARD MODAL -->
    <div id="add-card-modal">
        <div class="modal-sheet">
            <div class="flex justify-between items-center mb-8">
                <h2 class="text-lg font-black text-slate-900">Add New Card</h2>
                <button onclick="closeAddCard()" class="w-8 h-8 bg-slate-50 rounded-full flex items-center justify-center text-slate-400"><i class="fa-solid fa-xmark"></i></button>
            </div>
            
            <form onsubmit="saveCard(event)">
                <div class="input-group">
                    <input type="text" class="input-field" placeholder=" " required maxlength="19">
                    <label class="input-label">Card Number</label>
                    <i class="fa-brands fa-cc-visa absolute right-4 top-4 text-slate-300 text-xl"></i>
                </div>
                
                <div class="flex gap-4">
                    <div class="input-group w-1/2">
                        <input type="text" class="input-field" placeholder=" " required maxlength="5">
                        <label class="input-label">Expiry</label>
                    </div>
                    <div class="input-group w-1/2">
                        <input type="password" class="input-field" placeholder=" " required maxlength="3">
                        <label class="input-label">CVV</label>
                    </div>
                </div>

                <div class="input-group">
                    <input type="text" class="input-field" placeholder=" " required>
                    <label class="input-label">Cardholder Name</label>
                </div>

                <!-- CARD PASSCODE -->
                <div class="input-group">
                    <input type="password" class="input-field" placeholder=" " required maxlength="4" style="letter-spacing: 0.5em; font-family: monospace;">
                    <label class="input-label">Confirm Card PIN</label>
                </div>

                <button type="submit" id="link-btn" class="w-full bg-blue-600 text-white py-4 rounded-xl font-bold text-sm shadow-lg shadow-blue-200 active:scale-95 transition-transform mt-4">
                    Verify & Link
                </button>
            </form>
        </div>
    </div>

    <!-- 4. WALLET VORTEX -->
    <div id="wallet-overlay">
        <div class="vortex"></div>
        <div class="warp-card">
            <div class="absolute inset-0 bg-gradient-to-br from-blue-600 to-blue-900 p-4 rounded-2xl flex flex-col justify-between">
                <div class="flex justify-between text-white"><i class="fa-brands fa-apple text-xl"></i><span class="font-mono text-[10px]">VISA</span></div>
                <p class="text-white font-mono tracking-widest text-[12px]">**** 8144</p>
            </div>
        </div>
        
        <div class="apple-pass">
            <div class="pass-top"></div>
            <div class="mt-8 flex items-center gap-3">
                <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-white"><i class="fa-brands fa-cc-visa"></i></div>
                <div><p class="text-white font-bold text-[12px]">NovaPay Platinum</p><p class="text-gray-400 text-[9px]">**** 8144</p></div>
            </div>
            <div class="success-tick-wallet"><i class="fa-solid fa-check"></i></div>
        </div>
        
        <button class="dismiss-btn" onclick="closeWallet()">Return to Hub</button>
    </div>

    <!-- 5. VISA POPUP -->
    <div id="visa-popup">
        <div class="popup-box">
            <div class="w-14 h-14 bg-slate-900 rounded-full flex items-center justify-center text-white text-xl mb-4 mx-auto shadow-xl">
                <i class="fa-brands fa-cc-visa"></i>
            </div>
            <h2 class="text-lg font-black text-slate-900 mb-2">Visa Secure Channel</h2>
            <p id="popup-msg" class="text-[11px] text-slate-500 font-medium leading-relaxed mb-6">Connecting to global neural network...</p>
            <button onclick="closeVisaPopup()" class="w-full bg-slate-900 text-white py-3 rounded-full font-bold text-xs">Dismiss</button>
        </div>
    </div>

    <!-- 6. Watch Navigation -->
    <div id="floating-nav" class="fixed bottom-6 left-6 right-6 max-w-[calc(100%-48px)] mx-auto z-50">
        <div class="relative flex items-center">
            <nav class="watch-strap w-full rounded-full px-6 flex justify-between items-center">
                <div class="flex gap-10">
                    <a href="home.html" class="flex flex-col items-center gap-0.5 text-slate-300 transition-colors hover:text-slate-500">
                        <i class="fa-solid fa-house-chimney text-[18px]"></i>
                        <span class="text-[9px] font-bold">Home</span>
                    </a>
                    <a href="cards.html" class="flex flex-col items-center gap-0.5 text-blue-600">
                        <i class="fa-solid fa-credit-card text-[18px]"></i>
                        <span class="text-[9px] font-bold">Cards</span>
                    </a>
                </div>
                <div class="flex gap-10">
                    <a href="stats.html" class="flex flex-col items-center gap-0.5 text-slate-300 transition-colors hover:text-slate-500">
                        <i class="fa-solid fa-chart-line text-[18px]"></i>
                        <span class="text-[9px] font-bold">Stats</span>
                    </a>
                    <a href="user.html" class="flex flex-col items-center gap-0.5 text-slate-300 transition-colors hover:text-slate-500">
                        <i class="fa-solid fa-user-circle text-[18px]"></i>
                        <span class="text-[9px] font-bold">User</span>
                    </a>
                </div>
            </nav>
            <a href="pay.html" class="watch-case rounded-full flex items-center justify-center text-white cursor-pointer active:scale-95 transition-transform">
                <i class="fa-solid fa-qrcode text-[26px]"></i>
            </a>
        </div>
    </div>
    
      <script>
        window.onload = function() { setTimeout(() => { document.body.classList.add('loaded'); updateLimit(10); }, 850); };

        function flipCard() {
            document.getElementById('card-element').classList.toggle('flipped');
        }

        function toggleFreeze(btn) {
            const card = document.getElementById('card-element');
            const icon = btn.querySelector('.control-icon');
            const text = btn.querySelector('span');
            
            if(card.classList.contains('frozen')) {
                card.classList.remove('frozen');
                btn.style.borderColor = '#F1F5F9';
                icon.className = 'control-icon bg-blue-50 text-blue-600';
                text.innerText = 'Freeze';
            } else {
                card.classList.add('frozen');
                btn.style.borderColor = '#93C5FD';
                icon.className = 'control-icon bg-blue-500 text-white';
                text.innerText = 'Unfreeze';
            }
        }

        function revealNumber(btn) {
            const numEl = document.getElementById('card-number');
            const realNum = "4892 1100 2931 8144";
            const masked = "**** **** **** 8144";
            const icon = btn.querySelector('i');
            const text = btn.querySelector('span');
            
            if(numEl.innerText.includes("*")) {
                let iterations = 0;
                const interval = setInterval(() => {
                    numEl.innerText = realNum.split("").map((char, index) => {
                        if(index < 15) return Math.floor(Math.random() * 10);
                        return char;
                    }).join("");
                    if(iterations >= 10) { clearInterval(interval); numEl.innerText = realNum; }
                    iterations++;
                }, 40);
                icon.className = "fa-regular fa-eye-slash"; text.innerText = "Hide";
            } else {
                numEl.innerText = masked;
                icon.className = "fa-regular fa-eye"; text.innerText = "Reveal";
            }
        }

        function updateLimit(val) {
            document.getElementById('limit-val').innerText = '$' + parseInt(val).toLocaleString();
            const spend = 3;
            const limit = parseInt(val);
            let percent = (spend / limit) * 100;
            if (percent > 100) percent = 100;
            if (limit === 0) percent = 100;
            
            document.getElementById('spend-pct').innerText = `(${percent.toFixed(1)}%)`;
            document.getElementById('water-fill').style.height = percent + '%';
        }

        function triggerWallet() {
            const overlay = document.getElementById('wallet-overlay');
            overlay.style.display = 'flex';
            document.body.classList.add('lock-scroll');
            setTimeout(() => document.body.classList.add('warp-active'), 100);
        }

        function closeWallet() {
            const overlay = document.getElementById('wallet-overlay');
            document.body.classList.remove('warp-active');
            setTimeout(() => { 
                overlay.style.display = 'none'; 
                document.body.classList.remove('lock-scroll'); 
            }, 500);
        }

        function openVisaPopup(action) {
            document.getElementById('popup-msg').innerText = "Processing " + action + " request via Visa Secure Channel...";
            const p = document.getElementById('visa-popup');
            p.style.display = 'flex';
            setTimeout(() => p.classList.add('active'), 10);
        }

        function closeVisaPopup() {
            const p = document.getElementById('visa-popup');
            p.classList.remove('active');
            setTimeout(() => p.style.display = 'none', 300);
        }

        function scrollToLimit() {
            document.getElementById('limit-section').scrollIntoView({ behavior: 'smooth' });
        }

        // --- ADD CARD LOGIC ---
        function openAddCard() {
            document.getElementById('add-card-modal').style.display = 'flex';
            setTimeout(() => document.getElementById('add-card-modal').classList.add('active'), 10);
        }
        function closeAddCard() {
            document.getElementById('add-card-modal').classList.remove('active');
            setTimeout(() => document.getElementById('add-card-modal').style.display = 'none', 400);
        }
        function saveCard(e) {
            e.preventDefault();
            const btn = document.getElementById('link-btn');
            btn.innerHTML = '<div class="spinner border-blue-200 border-t-white mx-auto"></div>';
            setTimeout(() => {
                btn.innerHTML = '<i class="fa-solid fa-triangle-exclamation mr-2"></i> Wrong PassCode ';
                btn.style.backgroundColor = '#EF4444'; // Red
                setTimeout(() => {
                    btn.innerHTML = 'Link Card';
                    btn.style.backgroundColor = '#0052FF'; // Reset
                }, 2000);
            }, 1500);
        }
    </script>
</body>
</html>
